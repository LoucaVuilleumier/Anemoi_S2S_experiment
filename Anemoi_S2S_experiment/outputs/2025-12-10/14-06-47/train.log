[2025-12-10 14:06:47,841][anemoi.training.train.train][INFO] - Skipping config validation.
[2025-12-10 14:06:47,842][anemoi.training.train.train][INFO] - Starting from checkpoint: False
[2025-12-10 14:06:47,843][anemoi.training.train.train][INFO] - Run id: 99feec0f-fa0c-48ec-9c4f-afaf67aca1fa
[2025-12-10 14:06:47,843][anemoi.training.train.train][INFO] - Checkpoints path: output_training/checkpoint/99feec0f-fa0c-48ec-9c4f-afaf67aca1fa
[2025-12-10 14:06:47,843][anemoi.training.train.train][INFO] - Plots path: output_training/plots/99feec0f-fa0c-48ec-9c4f-afaf67aca1fa
[2025-12-10 14:08:10,720][anemoi.graphs.nodes.builders.from_file][INFO] - Reading the dataset from /home/mlx/ai-ml/datasets//aifs-ea-an-oper-0001-mars-o96-1979-2023-6h-v8.zarr.
[2025-12-10 14:08:21,931][anemoi.utils.config][INFO] - Using environment variable ANEMOI_CONFIG_PATH to override the anemoi config key 'path.'
[2025-12-10 14:08:31,993][anemoi.graphs.edges.builders.cutoff][INFO] - Using CutOff-Edges (with radius = 144.6 km) between data and hidden.
[2025-12-10 14:08:33,047][anemoi.graphs.edges.builders.base][WARNING] - The 'torch-cluster' library is not installed. Installing 'torch-cluster' can significantly improve performance for graph creation. You can install it using 'pip install torch-cluster'.
[2025-12-10 14:08:44,544][anemoi.graphs.edges.builders.knn][INFO] - Using KNN-Edges (with 3 nearest neighbours) between hidden and data.
[2025-12-10 14:08:44,545][anemoi.graphs.edges.builders.base][WARNING] - The 'torch-cluster' library is not installed. Installing 'torch-cluster' can significantly improve performance for graph creation. You can install it using 'pip install torch-cluster'.
[2025-12-10 14:08:44,612][anemoi.graphs.create][INFO] - Cleaning graph.
[2025-12-10 14:08:44,612][anemoi.graphs.create][INFO] - _grid_reference_distance deleted from graph.
[2025-12-10 14:08:44,613][anemoi.graphs.create][INFO] - _dataset deleted from graph.
[2025-12-10 14:08:44,613][anemoi.graphs.create][INFO] - _grid_reference_distance deleted from graph.
[2025-12-10 14:08:44,931][anemoi.graphs.create][INFO] - Graph saved at graphs/graph.pkl.
[2025-12-10 14:08:47,061][anemoi.training.data.datamodule.singledatamodule][WARNING] - Falling back rollout to: 1
[2025-12-10 14:08:47,062][anemoi.training.data.datamodule.singledatamodule][INFO] - Timeincrement set to 1 for data with frequency, 21600, and timestep, 21600
[2025-12-10 14:08:47,064][anemoi.training.train.train][INFO] - Number of data variables: 101
[2025-12-10 14:08:47,065][anemoi.training.train.train][INFO] - Training limits: max_epochs=2, max_steps=300. Training will stop when either limit is reached first. Learning rate scheduler will run for 300000 steps.
[2025-12-10 14:10:29,218][anemoi.training.diagnostics.callbacks.plot][INFO] - Setting up asynchronous plotting ...
[2025-12-10 14:10:29,220][anemoi.training.diagnostics.callbacks.plot][INFO] - Setting up asynchronous plotting ...
[2025-12-10 14:10:29,298][anemoi.training.diagnostics.callbacks.plot][INFO] - Setting up asynchronous plotting ...
[2025-12-10 14:10:29,298][anemoi.training.diagnostics.callbacks.plot][INFO] - Using defined accumulation colormap for fields: ['tp', 'cp']
[2025-12-10 14:10:29,300][anemoi.training.diagnostics.callbacks.plot][INFO] - Setting up asynchronous plotting ...
[2025-12-10 14:10:29,302][anemoi.training.diagnostics.callbacks.plot][INFO] - Setting up asynchronous plotting ...
[2025-12-10 14:10:29,302][anemoi.training.diagnostics.callbacks.plot][INFO] - Using precip histogram plotting method for fields: ['tp', 'cp'].
[2025-12-10 14:17:21,073][anemoi.models.preprocessing.normalizer][INFO] - Normalizing: cos_julian_day is not normalized.
[2025-12-10 14:17:21,073][anemoi.models.preprocessing.normalizer][INFO] - Normalizing: cos_latitude is not normalized.
[2025-12-10 14:17:21,073][anemoi.models.preprocessing.normalizer][INFO] - Normalizing: cos_local_time is not normalized.
[2025-12-10 14:17:21,073][anemoi.models.preprocessing.normalizer][INFO] - Normalizing: cos_longitude is not normalized.
[2025-12-10 14:17:21,074][anemoi.models.preprocessing.normalizer][INFO] - Normalizing: insolation is not normalized.
[2025-12-10 14:17:21,074][anemoi.models.preprocessing.normalizer][INFO] - Normalizing: lsm is not normalized.
[2025-12-10 14:17:21,074][anemoi.models.preprocessing.normalizer][INFO] - Normalizing: sin_julian_day is not normalized.
[2025-12-10 14:17:21,074][anemoi.models.preprocessing.normalizer][INFO] - Normalizing: sin_latitude is not normalized.
[2025-12-10 14:17:21,074][anemoi.models.preprocessing.normalizer][INFO] - Normalizing: sin_local_time is not normalized.
[2025-12-10 14:17:21,074][anemoi.models.preprocessing.normalizer][INFO] - Normalizing: sin_longitude is not normalized.
[2025-12-10 14:17:22,020][anemoi.models.layers.utils][INFO] - Linear kernel: torch.nn.Linear.
[2025-12-10 14:17:22,020][anemoi.models.layers.utils][INFO] - LayerNorm kernel: torch.nn.LayerNorm.
[2025-12-10 14:17:22,021][anemoi.models.layers.utils][INFO] - Activation kernel: torch.nn.GELU.
[2025-12-10 14:17:22,107][anemoi.models.layers.utils][INFO] - QueryNorm kernel: anemoi.models.layers.normalization.AutocastLayerNorm.
[2025-12-10 14:17:22,108][anemoi.models.layers.utils][INFO] - KeyNorm kernel: anemoi.models.layers.normalization.AutocastLayerNorm.
[2025-12-10 14:17:22,446][anemoi.models.layers.utils][INFO] - Linear kernel: torch.nn.Linear.
[2025-12-10 14:17:22,447][anemoi.models.layers.utils][INFO] - LayerNorm kernel: torch.nn.LayerNorm.
[2025-12-10 14:17:22,447][anemoi.models.layers.utils][INFO] - Activation kernel: torch.nn.GELU.
[2025-12-10 14:17:22,448][anemoi.models.layers.utils][INFO] - QueryNorm kernel: anemoi.models.layers.normalization.AutocastLayerNorm.
[2025-12-10 14:17:22,449][anemoi.models.layers.utils][INFO] - KeyNorm kernel: anemoi.models.layers.normalization.AutocastLayerNorm.
[2025-12-10 14:17:22,449][anemoi.models.layers.attention][INFO] - Using flash_attention
[2025-12-10 14:17:24,053][anemoi.models.layers.attention][INFO] - Using flash_attention
[2025-12-10 14:17:24,123][anemoi.models.layers.attention][INFO] - Using flash_attention
[2025-12-10 14:17:24,192][anemoi.models.layers.attention][INFO] - Using flash_attention
[2025-12-10 14:17:24,262][anemoi.models.layers.attention][INFO] - Using flash_attention
[2025-12-10 14:17:24,332][anemoi.models.layers.attention][INFO] - Using flash_attention
[2025-12-10 14:17:24,402][anemoi.models.layers.attention][INFO] - Using flash_attention
[2025-12-10 14:17:24,474][anemoi.models.layers.attention][INFO] - Using flash_attention
[2025-12-10 14:17:24,545][anemoi.models.layers.attention][INFO] - Using flash_attention
[2025-12-10 14:17:24,615][anemoi.models.layers.attention][INFO] - Using flash_attention
[2025-12-10 14:17:24,686][anemoi.models.layers.attention][INFO] - Using flash_attention
[2025-12-10 14:17:24,756][anemoi.models.layers.attention][INFO] - Using flash_attention
[2025-12-10 14:17:24,825][anemoi.models.layers.attention][INFO] - Using flash_attention
[2025-12-10 14:17:24,895][anemoi.models.layers.attention][INFO] - Using flash_attention
[2025-12-10 14:17:24,966][anemoi.models.layers.attention][INFO] - Using flash_attention
[2025-12-10 14:17:25,035][anemoi.models.layers.attention][INFO] - Using flash_attention
[2025-12-10 14:17:25,110][anemoi.models.layers.utils][INFO] - Linear kernel: torch.nn.Linear.
[2025-12-10 14:17:25,111][anemoi.models.layers.utils][INFO] - LayerNorm kernel: torch.nn.LayerNorm.
[2025-12-10 14:17:25,112][anemoi.models.layers.utils][INFO] - Activation kernel: torch.nn.GELU.
[2025-12-10 14:17:25,112][anemoi.models.layers.utils][INFO] - QueryNorm kernel: anemoi.models.layers.normalization.AutocastLayerNorm.
[2025-12-10 14:17:25,113][anemoi.models.layers.utils][INFO] - KeyNorm kernel: anemoi.models.layers.normalization.AutocastLayerNorm.
[2025-12-10 14:17:25,673][anemoi.training.losses.scalers.variable_level][INFO] - Variable Level Scaling: Applying ReluVariableLevelScaler scaling to pl variables ({'param': ['q', 't', 'u', 'v', 'w', 'z']})
[2025-12-10 14:17:25,673][anemoi.training.losses.scalers.variable_level][INFO] - with slope = 0.001 and y-intercept/minimum = 0.2.
[2025-12-10 14:17:26,141][anemoi.training.train.train][INFO] - The following submodules will NOT be trained: []
[2025-12-10 14:18:21,894][anemoi.training.data.datamodule.singledatamodule][WARNING] - Falling back rollout to: 1
[2025-12-10 14:18:22,586][anemoi.models.data_indices.collection][INFO] - The order of the variables in the model matches the order in the data.
[2025-12-10 14:18:22,698][anemoi.training.data.dataset.singledataset][INFO] - Worker 3 (pid 1528803, global_rank 0, model comm group 0)  has low/high range 546 / 728
[2025-12-10 14:18:22,699][anemoi.training.data.dataset.singledataset][INFO] - Worker 4 (pid 1528805, global_rank 0, model comm group 0)  has low/high range 728 / 910
[2025-12-10 14:18:22,700][anemoi.training.data.dataset.singledataset][INFO] - Worker 2 (pid 1528801, global_rank 0, model comm group 0)  has low/high range 364 / 546
[2025-12-10 14:18:22,700][anemoi.training.data.dataset.singledataset][INFO] - Worker 6 (pid 1528809, global_rank 0, model comm group 0)  has low/high range 1092 / 1274
[2025-12-10 14:18:22,702][anemoi.training.data.dataset.singledataset][INFO] - Worker 5 (pid 1528807, global_rank 0, model comm group 0)  has low/high range 910 / 1092
[2025-12-10 14:18:22,702][anemoi.training.data.dataset.singledataset][INFO] - Worker 0 (pid 1528797, global_rank 0, model comm group 0)  has low/high range 0 / 182
[2025-12-10 14:18:22,703][anemoi.training.data.dataset.singledataset][INFO] - Worker 7 (pid 1528811, global_rank 0, model comm group 0)  has low/high range 1274 / 1456
[2025-12-10 14:18:22,703][anemoi.training.data.dataset.singledataset][INFO] - Worker 1 (pid 1528798, global_rank 0, model comm group 0)  has low/high range 182 / 364
[2025-12-10 14:18:22,723][anemoi.training.data.dataset.singledataset][INFO] - Worker 7 (validation, pid 1528811, glob. rank 0, model comm group 0, group_rank 0, seed group id 0, base_seed 36898710, sanity rnd 0.891581)
[2025-12-10 14:18:22,723][anemoi.training.data.dataset.singledataset][INFO] - Worker 1 (validation, pid 1528798, glob. rank 0, model comm group 0, group_rank 0, seed group id 0, base_seed 36898710, sanity rnd 0.891581)
[2025-12-10 14:18:22,724][anemoi.training.data.dataset.singledataset][INFO] - Worker 0 (validation, pid 1528797, glob. rank 0, model comm group 0, group_rank 0, seed group id 0, base_seed 36898710, sanity rnd 0.891581)
[2025-12-10 14:18:22,724][anemoi.training.data.dataset.singledataset][INFO] - Worker 6 (validation, pid 1528809, glob. rank 0, model comm group 0, group_rank 0, seed group id 0, base_seed 36898710, sanity rnd 0.891581)
[2025-12-10 14:18:22,725][anemoi.training.data.dataset.singledataset][INFO] - Worker 5 (validation, pid 1528807, glob. rank 0, model comm group 0, group_rank 0, seed group id 0, base_seed 36898710, sanity rnd 0.891581)
[2025-12-10 14:18:22,725][anemoi.training.data.dataset.singledataset][INFO] - Worker 3 (validation, pid 1528803, glob. rank 0, model comm group 0, group_rank 0, seed group id 0, base_seed 36898710, sanity rnd 0.891581)
[2025-12-10 14:18:22,726][anemoi.training.data.dataset.singledataset][INFO] - Worker 2 (validation, pid 1528801, glob. rank 0, model comm group 0, group_rank 0, seed group id 0, base_seed 36898710, sanity rnd 0.891581)
[2025-12-10 14:18:22,727][anemoi.training.data.dataset.singledataset][INFO] - Worker 4 (validation, pid 1528805, glob. rank 0, model comm group 0, group_rank 0, seed group id 0, base_seed 36898710, sanity rnd 0.891581)
