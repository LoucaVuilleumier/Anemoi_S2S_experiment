[2025-12-09 15:10:36,649][anemoi.training.train.train][INFO] - Skipping config validation.
[2025-12-09 15:10:36,650][anemoi.training.train.train][INFO] - Starting from checkpoint: False
[2025-12-09 15:10:36,650][anemoi.training.train.train][INFO] - Run id: cb9667ed-f656-4a3b-b0b2-4abe4ac017bc
[2025-12-09 15:10:36,650][anemoi.training.train.train][INFO] - Checkpoints path: output_training/checkpoint/cb9667ed-f656-4a3b-b0b2-4abe4ac017bc
[2025-12-09 15:10:36,651][anemoi.training.train.train][INFO] - Plots path: output_training/plots/cb9667ed-f656-4a3b-b0b2-4abe4ac017bc
[2025-12-09 15:11:19,136][anemoi.graphs.nodes.builders.from_file][INFO] - Reading the dataset from /home/mlx/ai-ml/datasets//aifs-ea-an-oper-0001-mars-o96-1979-2023-6h-v8.zarr.
[2025-12-09 15:11:22,567][anemoi.utils.config][INFO] - Using environment variable ANEMOI_CONFIG_PATH to override the anemoi config key 'path.'
[2025-12-09 15:11:30,187][anemoi.graphs.edges.builders.cutoff][INFO] - Using CutOff-Edges (with radius = 144.6 km) between data and hidden.
[2025-12-09 15:11:31,082][anemoi.graphs.edges.builders.base][WARNING] - The 'torch-cluster' library is not installed. Installing 'torch-cluster' can significantly improve performance for graph creation. You can install it using 'pip install torch-cluster'.
[2025-12-09 15:11:40,728][anemoi.graphs.edges.builders.knn][INFO] - Using KNN-Edges (with 3 nearest neighbours) between hidden and data.
[2025-12-09 15:11:40,728][anemoi.graphs.edges.builders.base][WARNING] - The 'torch-cluster' library is not installed. Installing 'torch-cluster' can significantly improve performance for graph creation. You can install it using 'pip install torch-cluster'.
[2025-12-09 15:11:40,796][anemoi.graphs.create][INFO] - Cleaning graph.
[2025-12-09 15:11:40,796][anemoi.graphs.create][INFO] - _grid_reference_distance deleted from graph.
[2025-12-09 15:11:40,796][anemoi.graphs.create][INFO] - _dataset deleted from graph.
[2025-12-09 15:11:40,796][anemoi.graphs.create][INFO] - _grid_reference_distance deleted from graph.
[2025-12-09 15:11:41,098][anemoi.graphs.create][INFO] - Graph saved at graphs/graph.pkl.
[2025-12-09 15:11:42,172][anemoi.training.data.datamodule.singledatamodule][WARNING] - Falling back rollout to: 1
[2025-12-09 15:11:42,172][anemoi.training.data.datamodule.singledatamodule][INFO] - Timeincrement set to 1 for data with frequency, 21600, and timestep, 21600
[2025-12-09 15:11:42,175][anemoi.training.train.train][INFO] - Number of data variables: 101
[2025-12-09 15:11:42,175][anemoi.training.train.train][INFO] - Training limits: max_epochs=2, max_steps=300. Training will stop when either limit is reached first. Learning rate scheduler will run for 300000 steps.
[2025-12-09 15:12:36,541][anemoi.training.diagnostics.callbacks.plot][INFO] - Setting up asynchronous plotting ...
[2025-12-09 15:12:36,544][anemoi.training.diagnostics.callbacks.plot][INFO] - Setting up asynchronous plotting ...
[2025-12-09 15:12:36,576][anemoi.training.diagnostics.callbacks.plot][INFO] - Setting up asynchronous plotting ...
[2025-12-09 15:12:36,576][anemoi.training.diagnostics.callbacks.plot][INFO] - Using defined accumulation colormap for fields: ['tp', 'cp']
[2025-12-09 15:12:36,578][anemoi.training.diagnostics.callbacks.plot][INFO] - Setting up asynchronous plotting ...
[2025-12-09 15:12:36,580][anemoi.training.diagnostics.callbacks.plot][INFO] - Setting up asynchronous plotting ...
[2025-12-09 15:12:36,580][anemoi.training.diagnostics.callbacks.plot][INFO] - Using precip histogram plotting method for fields: ['tp', 'cp'].
[2025-12-09 15:17:51,031][anemoi.models.preprocessing.normalizer][INFO] - Normalizing: cos_julian_day is not normalized.
[2025-12-09 15:17:51,032][anemoi.models.preprocessing.normalizer][INFO] - Normalizing: cos_latitude is not normalized.
[2025-12-09 15:17:51,033][anemoi.models.preprocessing.normalizer][INFO] - Normalizing: cos_local_time is not normalized.
[2025-12-09 15:17:51,033][anemoi.models.preprocessing.normalizer][INFO] - Normalizing: cos_longitude is not normalized.
[2025-12-09 15:17:51,033][anemoi.models.preprocessing.normalizer][INFO] - Normalizing: insolation is not normalized.
[2025-12-09 15:17:51,033][anemoi.models.preprocessing.normalizer][INFO] - Normalizing: lsm is not normalized.
[2025-12-09 15:17:51,033][anemoi.models.preprocessing.normalizer][INFO] - Normalizing: sin_julian_day is not normalized.
[2025-12-09 15:17:51,033][anemoi.models.preprocessing.normalizer][INFO] - Normalizing: sin_latitude is not normalized.
[2025-12-09 15:17:51,033][anemoi.models.preprocessing.normalizer][INFO] - Normalizing: sin_local_time is not normalized.
[2025-12-09 15:17:51,033][anemoi.models.preprocessing.normalizer][INFO] - Normalizing: sin_longitude is not normalized.
[2025-12-09 15:17:51,765][anemoi.models.layers.utils][INFO] - Linear kernel: torch.nn.Linear.
[2025-12-09 15:17:51,767][anemoi.models.layers.utils][INFO] - LayerNorm kernel: torch.nn.LayerNorm.
[2025-12-09 15:17:51,767][anemoi.models.layers.utils][INFO] - Activation kernel: torch.nn.GELU.
[2025-12-09 15:17:51,833][anemoi.models.layers.utils][INFO] - QueryNorm kernel: anemoi.models.layers.normalization.AutocastLayerNorm.
[2025-12-09 15:17:51,834][anemoi.models.layers.utils][INFO] - KeyNorm kernel: anemoi.models.layers.normalization.AutocastLayerNorm.
[2025-12-09 15:17:52,231][anemoi.models.layers.utils][INFO] - Linear kernel: torch.nn.Linear.
[2025-12-09 15:17:52,232][anemoi.models.layers.utils][INFO] - LayerNorm kernel: torch.nn.LayerNorm.
[2025-12-09 15:17:52,233][anemoi.models.layers.utils][INFO] - Activation kernel: torch.nn.GELU.
[2025-12-09 15:17:52,233][anemoi.models.layers.utils][INFO] - QueryNorm kernel: anemoi.models.layers.normalization.AutocastLayerNorm.
[2025-12-09 15:17:52,234][anemoi.models.layers.utils][INFO] - KeyNorm kernel: anemoi.models.layers.normalization.AutocastLayerNorm.
[2025-12-09 15:17:52,234][anemoi.models.layers.attention][INFO] - Using flash_attention
[2025-12-09 15:17:54,017][anemoi.models.layers.attention][INFO] - Using flash_attention
[2025-12-09 15:17:54,086][anemoi.models.layers.attention][INFO] - Using flash_attention
[2025-12-09 15:17:54,157][anemoi.models.layers.attention][INFO] - Using flash_attention
[2025-12-09 15:17:54,226][anemoi.models.layers.attention][INFO] - Using flash_attention
[2025-12-09 15:17:54,296][anemoi.models.layers.attention][INFO] - Using flash_attention
[2025-12-09 15:17:54,366][anemoi.models.layers.attention][INFO] - Using flash_attention
[2025-12-09 15:17:54,437][anemoi.models.layers.attention][INFO] - Using flash_attention
[2025-12-09 15:17:54,507][anemoi.models.layers.attention][INFO] - Using flash_attention
[2025-12-09 15:17:54,576][anemoi.models.layers.attention][INFO] - Using flash_attention
[2025-12-09 15:17:54,647][anemoi.models.layers.attention][INFO] - Using flash_attention
[2025-12-09 15:17:54,716][anemoi.models.layers.attention][INFO] - Using flash_attention
[2025-12-09 15:17:54,788][anemoi.models.layers.attention][INFO] - Using flash_attention
[2025-12-09 15:17:54,857][anemoi.models.layers.attention][INFO] - Using flash_attention
[2025-12-09 15:17:54,927][anemoi.models.layers.attention][INFO] - Using flash_attention
[2025-12-09 15:17:54,997][anemoi.models.layers.attention][INFO] - Using flash_attention
[2025-12-09 15:17:55,072][anemoi.models.layers.utils][INFO] - Linear kernel: torch.nn.Linear.
[2025-12-09 15:17:55,072][anemoi.models.layers.utils][INFO] - LayerNorm kernel: torch.nn.LayerNorm.
[2025-12-09 15:17:55,073][anemoi.models.layers.utils][INFO] - Activation kernel: torch.nn.GELU.
[2025-12-09 15:17:55,074][anemoi.models.layers.utils][INFO] - QueryNorm kernel: anemoi.models.layers.normalization.AutocastLayerNorm.
[2025-12-09 15:17:55,074][anemoi.models.layers.utils][INFO] - KeyNorm kernel: anemoi.models.layers.normalization.AutocastLayerNorm.
[2025-12-09 15:17:55,717][anemoi.training.losses.scalers.variable_level][INFO] - Variable Level Scaling: Applying ReluVariableLevelScaler scaling to pl variables ({'param': ['q', 't', 'u', 'v', 'w', 'z']})
[2025-12-09 15:17:55,717][anemoi.training.losses.scalers.variable_level][INFO] - with slope = 0.001 and y-intercept/minimum = 0.2.
[2025-12-09 15:17:56,110][anemoi.training.train.train][INFO] - The following submodules will NOT be trained: []
[2025-12-09 15:18:51,595][anemoi.training.data.datamodule.singledatamodule][WARNING] - Falling back rollout to: 1
[2025-12-09 15:18:52,226][anemoi.models.data_indices.collection][INFO] - The order of the variables in the model matches the order in the data.
[2025-12-09 15:18:52,323][anemoi.training.data.dataset.singledataset][INFO] - Worker 5 (pid 552736, global_rank 0, model comm group 0)  has low/high range 910 / 1092
[2025-12-09 15:18:52,323][anemoi.training.data.dataset.singledataset][INFO] - Worker 2 (pid 552729, global_rank 0, model comm group 0)  has low/high range 364 / 546
[2025-12-09 15:18:52,325][anemoi.training.data.dataset.singledataset][INFO] - Worker 0 (pid 552724, global_rank 0, model comm group 0)  has low/high range 0 / 182
[2025-12-09 15:18:52,325][anemoi.training.data.dataset.singledataset][INFO] - Worker 7 (pid 552740, global_rank 0, model comm group 0)  has low/high range 1274 / 1456
[2025-12-09 15:18:52,326][anemoi.training.data.dataset.singledataset][INFO] - Worker 3 (pid 552732, global_rank 0, model comm group 0)  has low/high range 546 / 728
[2025-12-09 15:18:52,326][anemoi.training.data.dataset.singledataset][INFO] - Worker 6 (pid 552738, global_rank 0, model comm group 0)  has low/high range 1092 / 1274
[2025-12-09 15:18:52,327][anemoi.training.data.dataset.singledataset][INFO] - Worker 4 (pid 552734, global_rank 0, model comm group 0)  has low/high range 728 / 910
[2025-12-09 15:18:52,328][anemoi.training.data.dataset.singledataset][INFO] - Worker 1 (pid 552726, global_rank 0, model comm group 0)  has low/high range 182 / 364
[2025-12-09 15:18:52,467][anemoi.training.data.dataset.singledataset][INFO] - Worker 1 (validation, pid 552726, glob. rank 0, model comm group 0, group_rank 0, seed group id 0, base_seed 36474506, sanity rnd 0.203145)
[2025-12-09 15:18:52,467][anemoi.training.data.dataset.singledataset][INFO] - Worker 7 (validation, pid 552740, glob. rank 0, model comm group 0, group_rank 0, seed group id 0, base_seed 36474506, sanity rnd 0.203145)
[2025-12-09 15:18:52,468][anemoi.training.data.dataset.singledataset][INFO] - Worker 4 (validation, pid 552734, glob. rank 0, model comm group 0, group_rank 0, seed group id 0, base_seed 36474506, sanity rnd 0.203145)
[2025-12-09 15:18:52,468][anemoi.training.data.dataset.singledataset][INFO] - Worker 6 (validation, pid 552738, glob. rank 0, model comm group 0, group_rank 0, seed group id 0, base_seed 36474506, sanity rnd 0.203145)
[2025-12-09 15:18:52,469][anemoi.training.data.dataset.singledataset][INFO] - Worker 3 (validation, pid 552732, glob. rank 0, model comm group 0, group_rank 0, seed group id 0, base_seed 36474506, sanity rnd 0.203145)
[2025-12-09 15:18:52,469][anemoi.training.data.dataset.singledataset][INFO] - Worker 2 (validation, pid 552729, glob. rank 0, model comm group 0, group_rank 0, seed group id 0, base_seed 36474506, sanity rnd 0.203145)
[2025-12-09 15:18:52,470][anemoi.training.data.dataset.singledataset][INFO] - Worker 0 (validation, pid 552724, glob. rank 0, model comm group 0, group_rank 0, seed group id 0, base_seed 36474506, sanity rnd 0.203145)
[2025-12-09 15:18:52,471][anemoi.training.data.dataset.singledataset][INFO] - Worker 5 (validation, pid 552736, glob. rank 0, model comm group 0, group_rank 0, seed group id 0, base_seed 36474506, sanity rnd 0.203145)
