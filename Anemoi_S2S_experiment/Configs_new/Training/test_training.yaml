defaults:
- data: zarr
- dataloader: native_grid
- datamodule: single
- diagnostics: evaluation
- hardware: example
- graph: encoder_decoder_only
- model: transformer
- training: default
- _self_

config_validation: False

### This file is for local experimentation.
##  When you commit your changes, assign the new features and keywords
##  to the correct defaults.
# For example to change from default GPU count:
# hardware:
#   num_gpus_per_node: 1



diagnostics:
  log:
    mlflow:
      enabled: True
      offline: False
      terminal: True
      tracking_uri: "https://dummy_uri/health"
    wandb:
      enabled: False
      entity: "dummy_user"

hardware:
  accelerator: auto
  num_nodes: 1
  num_gpus_per_model: 1
  paths:
    data: "/home/mlx/ai-ml/datasets/"
    output: "Anemoi_S2S_experiment/output_training"
    graph: "Anemoi_S2S_experiment/graphs"
  files:
    dataset: aifs-ea-an-oper-0001-mars-o96-1979-2023-6h-v8.zarr
    graph: graph.pkl
  

model:
  num_channels: 1024
dataloader:
  limit_batches:
    training: null
    validation: 100

training:
  max_epochs: 2
  max_steps: 300
  lr:
    rate: 6.25e-5 # tests
    iterations: 300000
    min: 3e-7 #Not scaled by #GPU


  # Define available scalers
#  scalers:
#    # For inverse variance scaling, use VarTendencyScaler
#    variable:
#      _target_: anemoi.training.losses.scalers.VarTendencyScaler
#      # It automatically computes 1/var from statistics_tendencies
#      
#    # For area/grid weighting
#    grid_weights:
#      _target_: anemoi.training.losses.scalers.GraphNodeAttributeScaler
#      attribute_name: area_weight  # or whatever attribute exists in your graph_data
#  
#  training_loss:
#    _target_: anemoi.training.losses.PINNmse.PINNMSELoss
#    physics_weight: 1.0
#    alpha: 0.1
#    scalers: ["variable", "grid_weights"]